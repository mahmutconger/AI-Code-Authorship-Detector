{
    "code": "class StepTracker:\n    \"\"\"Track and render hierarchical steps without emojis, similar to Claude Code tree output.\n    Supports live auto-refresh via an attached refresh callback.\n    \"\"\"\n    def __init__(self, title: str):\n        self.title = title\n        self.steps = []  # list of dicts: {key, label, status, detail}\n        self.status_order = {\"pending\": 0, \"running\": 1, \"done\": 2, \"error\": 3, \"skipped\": 4}\n        self._refresh_cb = None  # callable to trigger UI refresh\n\n    def attach_refresh(self, cb):\n        self._refresh_cb = cb\n\n    def add(self, key: str, label: str):\n        if key not in [s[\"key\"] for s in self.steps]:\n            self.steps.append({\"key\": key, \"label\": label, \"status\": \"pending\", \"detail\": \"\"})\n            self._maybe_refresh()\n\n    def start(self, key: str, detail: str = \"\"):\n        self._update(key, status=\"running\", detail=detail)\n\n    def complete(self, key: str, detail: str = \"\"):\n        self._update(key, status=\"done\", detail=detail)\n\n    def error(self, key: str, detail: str = \"\"):\n        self._update(key, status=\"error\", detail=detail)\n\n    def skip(self, key: str, detail: str = \"\"):\n        self._update(key, status=\"skipped\", detail=detail)\n\n    def _update(self, key: str, status: str, detail: str):\n        for s in self.steps:\n            if s[\"key\"] == key:\n                s[\"status\"] = status\n                if detail:\n                    s[\"detail\"] = detail\n                self._maybe_refresh()\n                return\n\n        self.steps.append({\"key\": key, \"label\": key, \"status\": status, \"detail\": detail})\n        self._maybe_refresh()\n\n    def _maybe_refresh(self):\n        if self._refresh_cb:\n            try:\n                self._refresh_cb()\n            except Exception:\n                pass\n\n    def render(self):\n        tree = Tree(f\"[cyan]{self.title}[/cyan]\", guide_style=\"grey50\")\n        for step in self.steps:\n            label = step[\"label\"]\n            detail_text = step[\"detail\"].strip() if step[\"detail\"] else \"\"\n\n            status = step[\"status\"]\n            if status == \"done\":\n                symbol = \"[green]●[/green]\"\n            elif status == \"pending\":\n                symbol = \"[green dim]○[/green dim]\"\n            elif status == \"running\":\n                symbol = \"[cyan]○[/cyan]\"\n            elif status == \"error\":\n                symbol = \"[red]●[/red]\"\n            elif status == \"skipped\":\n                symbol = \"[yellow]○[/yellow]\"\n            else:\n                symbol = \" \"\n\n            if status == \"pending\":\n                # Entire line light gray (pending)\n                if detail_text:\n                    line = f\"{symbol} [bright_black]{label} ({detail_text})[/bright_black]\"\n                else:\n                    line = f\"{symbol} [bright_black]{label}[/bright_black]\"\n            else:\n                # Label white, detail (if any) light gray in parentheses\n                if detail_text:\n                    line = f\"{symbol} [white]{label}[/white] [bright_black]({detail_text})[/bright_black]\"\n                else:\n                    line = f\"{symbol} [white]{label}[/white]\"\n\n            tree.add(line)\n        return tree",
    "source": "github_repo:github/spec-kit",
    "file": "src/specify_cli/__init__.py",
    "license": "MIT",
    "language": "python"
}