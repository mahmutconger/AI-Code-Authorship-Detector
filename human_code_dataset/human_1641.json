{
    "code": "def get_answer_language(request):\n    \"\"\"\n    Return preferred answer language based on\n    domain name, query arguments and headers\n    \"\"\"\n\n    def _parse_accept_language(accept_language):\n        languages = accept_language.split(\",\")\n        locale_q_pairs = []\n\n        for language in languages:\n            try:\n                if language.split(\";\")[0] == language:\n                    # no q => q = 1\n                    locale_q_pairs.append((language.strip(), \"1\"))\n                else:\n                    locale = language.split(\";\")[0].strip()\n                    weight = language.split(\";\")[1].split(\"=\")[1]\n                    locale_q_pairs.append((locale, weight))\n            except IndexError:\n                pass\n\n        return locale_q_pairs\n\n    def _find_supported_language(accepted_languages):\n        for lang_tuple in accepted_languages:\n            lang = lang_tuple[0]\n            if \"-\" in lang:\n                lang = lang.split(\"-\", 1)[0]\n            return lang\n        return None\n\n    lang = None\n    hostname = request.headers[\"Host\"]\n    if hostname.endswith(\".cheat.sh\"):\n        lang = hostname[:-9]\n\n    if \"lang\" in request.args:\n        lang = request.args.get(\"lang\")\n\n    header_accept_language = request.headers.get(\"Accept-Language\", \"\")\n    if lang is None and header_accept_language:\n        lang = _find_supported_language(_parse_accept_language(header_accept_language))\n\n    return lang",
    "source": "github_repo:chubin/cheat.sh",
    "file": "bin/app.py",
    "license": "MIT",
    "language": "python"
}