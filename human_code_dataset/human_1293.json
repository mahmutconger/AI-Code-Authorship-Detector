{
    "code": "def _parse(self, doc: DoclingDocument):\n        \"\"\"\n        Main function that orchestrates the parsing by yielding components:\n        title, section headers, text, lists, and tables.\n        \"\"\"\n\n        in_list = False\n        in_table = False\n\n        text_data: list[str] = []\n        table_data: list[str] = []\n        caption_data: list[str] = []\n\n        # parents: dict[int, Union[DocItem, GroupItem, None]] = {}\n        parents: dict[int, Union[GroupItem, None]] = {}\n        # indents: dict[int, Union[DocItem, GroupItem, None]] = {}\n        indents: dict[int, Union[GroupItem, None]] = {}\n\n        for i in range(10):\n            parents[i] = None\n            indents[i] = None\n\n        for line in self.lines:\n            # line = line.strip()\n\n            # Title\n            if self._is_title(line):\n                item = self._parse_title(line)\n                level = item[\"level\"]\n\n                parents[level] = doc.add_text(\n                    text=item[\"text\"], label=DocItemLabel.TITLE\n                )\n\n            # Section headers\n            elif self._is_section_header(line):\n                item = self._parse_section_header(line)\n                level = item[\"level\"]\n\n                parents[level] = doc.add_heading(\n                    text=item[\"text\"], level=item[\"level\"], parent=parents[level - 1]\n                )\n                for k, v in parents.items():\n                    if k > level:\n                        parents[k] = None\n\n            # Lists\n            elif self._is_list_item(line):\n                _log.debug(f\"line: {line}\")\n                item = self._parse_list_item(line)\n                _log.debug(f\"parsed list-item: {item}\")\n\n                level = self._get_current_level(parents)\n\n                if not in_list:\n                    in_list = True\n\n                    parents[level + 1] = doc.add_group(\n                        parent=parents[level], name=\"list\", label=GroupLabel.LIST\n                    )\n                    indents[level + 1] = item[\"indent\"]\n\n                elif in_list and item[\"indent\"] > indents[level]:\n                    parents[level + 1] = doc.add_group(\n                        parent=parents[level], name=\"list\", label=GroupLabel.LIST\n                    )\n                    indents[level + 1] = item[\"indent\"]\n\n                elif in_list and item[\"indent\"] < indents[level]:\n                    # print(item[\"indent\"], \" => \", indents[level])\n                    while item[\"indent\"] < indents[level]:\n                        # print(item[\"indent\"], \" => \", indents[level])\n                        parents[level] = None\n                        indents[level] = None\n                        level -= 1\n\n                doc.add_list_item(\n                    item[\"text\"], parent=self._get_current_parent(parents)\n                )\n\n            elif in_list and not self._is_list_item(line):\n                in_list = False\n\n                level = self._get_current_level(parents)\n                parents[level] = None\n\n            # Tables\n            elif line.strip() == \"|===\" and not in_table:  # start of table\n                in_table = True\n\n            elif self._is_table_line(line):  # within a table\n                in_table = True\n                table_data.append(self._parse_table_line(line))\n\n            elif in_table and (\n                (not self._is_table_line(line)) or line.strip() == \"|===\"\n            ):  # end of table\n                caption = None\n                if len(caption_data) > 0:\n                    caption = doc.add_text(\n                        text=\" \".join(caption_data), label=DocItemLabel.CAPTION\n                    )\n\n                caption_data = []\n\n                data = self._populate_table_as_grid(table_data)\n                doc.add_table(\n                    data=data, parent=self._get_current_parent(parents), caption=caption\n                )\n\n                in_table = False\n                table_data = []\n\n            # Picture\n            elif self._is_picture(line):\n                caption = None\n                if len(caption_data) > 0:\n                    caption = doc.add_text(\n                        text=\" \".join(caption_data), label=DocItemLabel.CAPTION\n                    )\n\n                caption_data = []\n\n                item = self._parse_picture(line)\n\n                size: Size\n                if \"width\" in item and \"height\" in item:\n                    size = Size(width=int(item[\"width\"]), height=int(item[\"height\"]))\n                else:\n                    size = Size(width=DEFAULT_IMAGE_WIDTH, height=DEFAULT_IMAGE_HEIGHT)\n\n                uri = None\n                if (\n                    \"uri\" in item\n                    and not item[\"uri\"].startswith(\"http\")\n                    and item[\"uri\"].startswith(\"//\")\n                ):\n                    uri = \"file:\" + item[\"uri\"]\n                elif (\n                    \"uri\" in item\n                    and not item[\"uri\"].startswith(\"http\")\n                    and item[\"uri\"].startswith(\"/\")\n                ):\n                    uri = \"file:/\" + item[\"uri\"]\n                elif \"uri\" in item and not item[\"uri\"].startswith(\"http\"):\n                    uri = \"file://\" + item[\"uri\"]\n\n                image = ImageRef(mimetype=\"image/png\", size=size, dpi=70, uri=uri)\n                doc.add_picture(image=image, caption=caption)\n\n            # Caption\n            elif self._is_caption(line) and len(caption_data) == 0:\n                item = self._parse_caption(line)\n                caption_data.append(item[\"text\"])\n\n            elif (\n                len(line.strip()) > 0 and len(caption_data) > 0\n            ):  # allow multiline captions\n                item = self._parse_text(line)\n                caption_data.append(item[\"text\"])\n\n            # Plain text\n            elif len(line.strip()) == 0 and len(text_data) > 0:\n                doc.add_text(\n                    text=\" \".join(text_data),\n                    label=DocItemLabel.PARAGRAPH,\n                    parent=self._get_current_parent(parents),\n                )\n                text_data = []\n\n            elif len(line.strip()) > 0:  # allow multiline texts\n                item = self._parse_text(line)\n                text_data.append(item[\"text\"])\n\n        if len(text_data) > 0:\n            doc.add_text(\n                text=\" \".join(text_data),\n                label=DocItemLabel.PARAGRAPH,\n                parent=self._get_current_parent(parents),\n            )\n            text_data = []\n\n        if in_table and len(table_data) > 0:\n            data = self._populate_table_as_grid(table_data)\n            doc.add_table(data=data, parent=self._get_current_parent(parents))\n\n            in_table = False\n            table_data = []\n\n        return doc",
    "source": "github_repo:docling-project/docling",
    "file": "docling/backend/asciidoc_backend.py",
    "license": "MIT",
    "language": "python"
}