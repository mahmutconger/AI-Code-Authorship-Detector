{
    "code": "def main():\n    if sys.platform == \"win32\":\n        logger.info(\"Skipping build on windows\")\n        return\n\n    with tempfile.TemporaryDirectory() as tmpdir:\n        with gha_group(\"Downloading and Extracting Cairo\"):\n            logger.info(f\"Downloading cairo version {CAIRO_VERSION}\")\n            download_file(CAIRO_URL, os.path.join(tmpdir, \"cairo.tar.xz\"))\n\n            logger.info(\"Downloading cairo sha256sum\")\n            download_file(CAIRO_SHA256_URL, os.path.join(tmpdir, \"cairo.sha256sum\"))\n\n            logger.info(\"Verifying cairo sha256sum\")\n            with open(os.path.join(tmpdir, \"cairo.sha256sum\")) as file:\n                sha256sum = file.read().split()[0]\n            verify_sha256sum(os.path.join(tmpdir, \"cairo.tar.xz\"), sha256sum)\n\n            logger.info(\"Extracting cairo\")\n            extract_tar_xz(os.path.join(tmpdir, \"cairo.tar.xz\"), tmpdir)\n\n        with gha_group(\"Installing meson and ninja\"):\n            logger.info(\"Creating virtual environment\")\n            run_command([sys.executable, \"-m\", \"venv\", os.path.join(tmpdir, VENV_NAME)])\n\n            logger.info(\"Installing meson and ninja\")\n            run_command(\n                [\n                    os.path.join(tmpdir, VENV_NAME, \"bin\", \"pip\"),\n                    \"install\",\n                    \"meson\",\n                    \"ninja\",\n                ]\n            )\n\n        env_vars = {\n            # add the venv bin directory to PATH so that meson can find ninja\n            \"PATH\": f\"{os.path.join(tmpdir, VENV_NAME, 'bin')}{os.pathsep}{os.environ['PATH']}\",\n        }\n\n        with gha_group(\"Building and Installing Cairo\"):\n            logger.info(\"Running meson setup\")\n            run_command(\n                [\n                    os.path.join(tmpdir, VENV_NAME, \"bin\", \"meson\"),\n                    \"setup\",\n                    BUILD_DIR,\n                    f\"--prefix={INSTALL_PREFIX.absolute().as_posix()}\",\n                    \"--buildtype=release\",\n                    \"-Dtests=disabled\",\n                ],\n                cwd=os.path.join(tmpdir, f\"cairo-{CAIRO_VERSION}\"),\n                env=env_vars,\n            )\n\n            logger.info(\"Running meson compile\")\n            run_command(\n                [\n                    os.path.join(tmpdir, VENV_NAME, \"bin\", \"meson\"),\n                    \"compile\",\n                    \"-C\",\n                    BUILD_DIR,\n                ],\n                cwd=os.path.join(tmpdir, f\"cairo-{CAIRO_VERSION}\"),\n                env=env_vars,\n            )\n\n            logger.info(\"Running meson install\")\n            run_command(\n                [\n                    os.path.join(tmpdir, VENV_NAME, \"bin\", \"meson\"),\n                    \"install\",\n                    \"-C\",\n                    BUILD_DIR,\n                ],\n                cwd=os.path.join(tmpdir, f\"cairo-{CAIRO_VERSION}\"),\n                env=env_vars,\n            )\n\n        logger.info(f\"Successfully built cairo and installed it to {INSTALL_PREFIX}\")",
    "source": "github_repo:ManimCommunity/manim",
    "file": ".github/scripts/ci_build_cairo.py",
    "license": "MIT",
    "language": "python"
}