{
    "code": "class CustomSink:\n    def __init__(self, zone_configuration_path: str, classes: list[int]):\n        self.classes = classes\n        self.tracker = sv.ByteTrack(minimum_matching_threshold=0.5)\n        self.fps_monitor = sv.FPSMonitor()\n        self.polygons = load_zones_config(file_path=zone_configuration_path)\n        self.timers = [ClockBasedTimer() for _ in self.polygons]\n        self.zones = [\n            sv.PolygonZone(\n                polygon=polygon,\n                triggering_anchors=(sv.Position.CENTER,),\n            )\n            for polygon in self.polygons\n        ]\n\n    def on_prediction(self, result: dict, frame: VideoFrame) -> None:\n        self.fps_monitor.tick()\n        fps = self.fps_monitor.fps\n\n        detections = sv.Detections.from_inference(result)\n        detections = detections[find_in_list(detections.class_id, self.classes)]\n        detections = self.tracker.update_with_detections(detections)\n\n        annotated_frame = frame.image.copy()\n        annotated_frame = sv.draw_text(\n            scene=annotated_frame,\n            text=f\"{fps:.1f}\",\n            text_anchor=sv.Point(40, 30),\n            background_color=sv.Color.from_hex(\"#A351FB\"),\n            text_color=sv.Color.from_hex(\"#000000\"),\n        )\n\n        for idx, zone in enumerate(self.zones):\n            annotated_frame = sv.draw_polygon(\n                scene=annotated_frame, polygon=zone.polygon, color=COLORS.by_idx(idx)\n            )\n\n            detections_in_zone = detections[zone.trigger(detections)]\n            time_in_zone = self.timers[idx].tick(detections_in_zone)\n            custom_color_lookup = np.full(detections_in_zone.class_id.shape, idx)\n\n            annotated_frame = COLOR_ANNOTATOR.annotate(\n                scene=annotated_frame,\n                detections=detections_in_zone,\n                custom_color_lookup=custom_color_lookup,\n            )\n            labels = [\n                f\"#{tracker_id} {int(time // 60):02d}:{int(time % 60):02d}\"\n                for tracker_id, time in zip(detections_in_zone.tracker_id, time_in_zone)\n            ]\n            annotated_frame = LABEL_ANNOTATOR.annotate(\n                scene=annotated_frame,\n                detections=detections_in_zone,\n                labels=labels,\n                custom_color_lookup=custom_color_lookup,\n            )\n        cv2.imshow(\"Processed Video\", annotated_frame)\n        cv2.waitKey(1)",
    "source": "github_repo:roboflow/supervision",
    "file": "examples/time_in_zone/inference_stream_example.py",
    "license": "MIT",
    "language": "python"
}