{
    "code": "#!/usr/bin/env python3\nimport os\nimport shutil\nimport textwrap\nfrom pathlib import Path\n\nimport pdoc.render_helpers\n\nhere = Path(__file__).parent\n\nif os.environ.get(\"DOCS_ARCHIVE\", False):\n    edit_url_map = {}\nelse:\n    edit_url_map = {\n        \"mitmproxy\": \"https://github.com/mitmproxy/mitmproxy/blob/main/mitmproxy/\",\n    }\n\npdoc.render.configure(\n    template_directory=here / \"pdoc-template\",\n    edit_url_map=edit_url_map,\n    search=False,\n)\n# We can't configure Hugo, but we can configure pdoc.\npdoc.render_helpers.formatter.cssclass = \"chroma pdoc-code\"\n\nmodules = [\n    \"mitmproxy.addonmanager\",\n    \"mitmproxy.certs\",\n    \"mitmproxy.connection\",\n    \"mitmproxy.contentviews\",\n    \"mitmproxy.coretypes.multidict\",\n    \"mitmproxy.dns\",\n    \"mitmproxy.flow\",\n    \"mitmproxy.http\",\n    \"mitmproxy.net.server_spec\",\n    \"mitmproxy.proxy.context\",\n    \"mitmproxy.proxy.mode_specs\",\n    \"mitmproxy.proxy.server_hooks\",\n    \"mitmproxy.tcp\",\n    \"mitmproxy.tls\",\n    \"mitmproxy.udp\",\n    \"mitmproxy.websocket\",\n    here / \"..\" / \"src\" / \"generated\" / \"events.py\",\n]\n\npdoc.pdoc(*modules, output_directory=here / \"..\" / \"src\" / \"generated\" / \"api\")\n\napi_content = here / \"..\" / \"src\" / \"content\" / \"api\"\nif api_content.exists():\n    shutil.rmtree(api_content)\n\napi_content.mkdir()\n\nfor module in modules:\n    if isinstance(module, Path):\n        continue\n    filename = f\"api/{module.replace('.', '/')}.html\"\n    (api_content / f\"{module}.md\").write_bytes(\n        textwrap.dedent(\n            f\"\"\"\n        ---\n        title: \"{module}\"\n        url: \"{filename}\"\n\n        menu: api\n        ---\n\n        {{{{< readfile file=\"/generated/{filename}\" >}}}}\n        \"\"\"\n        ).encode()\n    )\n\n(here / \"../src/content/api/_index.md\").write_text(\n    textwrap.dedent(\n        f\"\"\"\\\n        ---\n        title: \"API Reference\"\n        ---\n\n        \"\"\"\n    ),\n    newline=\"\\n\",\n)",
    "source": "github_repo:mitmproxy/mitmproxy",
    "file": "docs/scripts/api-render.py",
    "license": "MIT",
    "language": "python"
}