{
    "code": "class Cluster:\n    __directions = (\"TB\", \"BT\", \"LR\", \"RL\")\n    __bgcolors = (\"#E5F5FD\", \"#EBF3E7\", \"#ECE8F6\", \"#FDF7E3\")\n\n    # fmt: off\n    _default_graph_attrs = {\n        \"shape\": \"box\",\n        \"style\": \"rounded\",\n        \"labeljust\": \"l\",\n        \"pencolor\": \"#AEB6BE\",\n        \"fontname\": \"Sans-Serif\",\n        \"fontsize\": \"12\",\n    }\n\n    # fmt: on\n\n    # FIXME:\n    #  Cluster direction does not work now. Graphviz couldn't render\n    #  correctly for a subgraph that has a different rank direction.\n    def __init__(\n        self,\n        label: str = \"cluster\",\n        direction: str = \"LR\",\n        graph_attr: Optional[dict] = None,\n    ):\n        \"\"\"Cluster represents a cluster context.\n\n        :param label: Cluster label.\n        :param direction: Data flow direction. Default is 'left to right'.\n        :param graph_attr: Provide graph_attr dot config attributes.\n        \"\"\"\n        if graph_attr is None:\n            graph_attr = {}\n        self.label = label\n        self.name = \"cluster_\" + self.label\n\n        self.dot = Digraph(self.name)\n\n        # Set attributes.\n        for k, v in self._default_graph_attrs.items():\n            self.dot.graph_attr[k] = v\n        self.dot.graph_attr[\"label\"] = self.label\n\n        if not self._validate_direction(direction):\n            raise ValueError(f'\"{direction}\" is not a valid direction')\n        self.dot.graph_attr[\"rankdir\"] = direction\n\n        # Node must be belong to a diagrams.\n        self._diagram = getdiagram()\n        if self._diagram is None:\n            raise EnvironmentError(\"Global diagrams context not set up\")\n        self._parent = getcluster()\n\n        # Set cluster depth for distinguishing the background color\n        self.depth = self._parent.depth + 1 if self._parent else 0\n        coloridx = self.depth % len(self.__bgcolors)\n        self.dot.graph_attr[\"bgcolor\"] = self.__bgcolors[coloridx]\n\n        # Merge passed in attributes\n        self.dot.graph_attr.update(graph_attr)\n\n    def __enter__(self):\n        setcluster(self)\n        return self\n\n    def __exit__(self, exc_type, exc_value, traceback):\n        if self._parent:\n            self._parent.subgraph(self.dot)\n        else:\n            self._diagram.subgraph(self.dot)\n        setcluster(self._parent)\n\n    def _validate_direction(self, direction: str) -> bool:\n        return direction.upper() in self.__directions\n\n    def node(self, nodeid: str, label: str, **attrs) -> None:\n        \"\"\"Create a new node in the cluster.\"\"\"\n        self.dot.node(nodeid, label=label, **attrs)\n\n    def subgraph(self, dot: Digraph) -> None:\n        self.dot.subgraph(dot)",
    "source": "github_repo:mingrammer/diagrams",
    "file": "diagrams/__init__.py",
    "license": "MIT",
    "language": "python"
}