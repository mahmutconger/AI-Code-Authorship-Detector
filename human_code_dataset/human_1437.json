{
    "code": "class Diagram:\n    __directions = (\"TB\", \"BT\", \"LR\", \"RL\")\n    __curvestyles = (\"ortho\", \"curved\")\n    __outformats = (\"png\", \"jpg\", \"svg\", \"pdf\", \"dot\")\n\n    # fmt: off\n    _default_graph_attrs = {\n        \"pad\": \"2.0\",\n        \"splines\": \"ortho\",\n        \"nodesep\": \"0.60\",\n        \"ranksep\": \"0.75\",\n        \"fontname\": \"Sans-Serif\",\n        \"fontsize\": \"15\",\n        \"fontcolor\": \"#2D3436\",\n    }\n    _default_node_attrs = {\n        \"shape\": \"box\",\n        \"style\": \"rounded\",\n        \"fixedsize\": \"true\",\n        \"width\": \"1.4\",\n        \"height\": \"1.4\",\n        \"labelloc\": \"b\",\n        # imagepos attribute is not backward compatible\n        # TODO: check graphviz version to see if \"imagepos\" is available >= 2.40\n        # https://github.com/xflr6/graphviz/blob/master/graphviz/backend.py#L248\n        # \"imagepos\": \"tc\",\n        \"imagescale\": \"true\",\n        \"fontname\": \"Sans-Serif\",\n        \"fontsize\": \"13\",\n        \"fontcolor\": \"#2D3436\",\n    }\n    _default_edge_attrs = {\n        \"color\": \"#7B8894\",\n    }\n\n    # fmt: on\n\n    # TODO: Label position option\n    # TODO: Save directory option (filename + directory?)\n    def __init__(\n        self,\n        name: str = \"\",\n        filename: str = \"\",\n        direction: str = \"LR\",\n        curvestyle: str = \"ortho\",\n        outformat: Union[str, list[str]] = \"png\",\n        autolabel: bool = False,\n        show: bool = True,\n        strict: bool = False,\n        graph_attr: Optional[dict] = None,\n        node_attr: Optional[dict] = None,\n        edge_attr: Optional[dict] = None,\n    ):\n        \"\"\"Diagram represents a global diagrams context.\n\n        :param name: Diagram name. It will be used for output filename if the\n            filename isn't given.\n        :param filename: The output filename, without the extension (.png).\n            If not given, it will be generated from the name.\n        :param direction: Data flow direction. Default is 'left to right'.\n        :param curvestyle: Curve bending style. One of \"ortho\" or \"curved\".\n        :param outformat: Output file format. Default is 'png'.\n        :param show: Open generated image after save if true, just only save otherwise.\n        :param graph_attr: Provide graph_attr dot config attributes.\n        :param node_attr: Provide node_attr dot config attributes.\n        :param edge_attr: Provide edge_attr dot config attributes.\n        :param strict: Rendering should merge multi-edges.\n        \"\"\"\n        if graph_attr is None:\n            graph_attr = {}\n        if node_attr is None:\n            node_attr = {}\n        if edge_attr is None:\n            edge_attr = {}\n        self.name = name\n        if not name and not filename:\n            filename = \"diagrams_image\"\n        elif not filename:\n            filename = \"_\".join(self.name.split()).lower()\n        self.filename = filename\n        self.dot = Digraph(self.name, filename=self.filename, strict=strict)\n\n        # Set attributes.\n        for k, v in self._default_graph_attrs.items():\n            self.dot.graph_attr[k] = v\n        self.dot.graph_attr[\"label\"] = self.name\n        for k, v in self._default_node_attrs.items():\n            self.dot.node_attr[k] = v\n        for k, v in self._default_edge_attrs.items():\n            self.dot.edge_attr[k] = v\n\n        if not self._validate_direction(direction):\n            raise ValueError(f'\"{direction}\" is not a valid direction')\n        self.dot.graph_attr[\"rankdir\"] = direction\n\n        if not self._validate_curvestyle(curvestyle):\n            raise ValueError(f'\"{curvestyle}\" is not a valid curvestyle')\n        self.dot.graph_attr[\"splines\"] = curvestyle\n\n        if isinstance(outformat, list):\n            for one_format in outformat:\n                if not self._validate_outformat(one_format):\n                    raise ValueError(\n                        f'\"{one_format}\" is not a valid output format')\n        else:\n            if not self._validate_outformat(outformat):\n                raise ValueError(f'\"{outformat}\" is not a valid output format')\n        self.outformat = outformat\n\n        # Merge passed in attributes\n        self.dot.graph_attr.update(graph_attr)\n        self.dot.node_attr.update(node_attr)\n        self.dot.edge_attr.update(edge_attr)\n\n        self.show = show\n        self.autolabel = autolabel\n\n    def __str__(self) -> str:\n        return str(self.dot)\n\n    def __enter__(self):\n        setdiagram(self)\n        return self\n\n    def __exit__(self, exc_type, exc_value, traceback):\n        self.render()\n        # Remove the graphviz file leaving only the image.\n        os.remove(self.filename)\n        setdiagram(None)\n\n    def _repr_png_(self):\n        return self.dot.pipe(format=\"png\")\n\n    def _validate_direction(self, direction: str) -> bool:\n        return direction.upper() in self.__directions\n\n    def _validate_curvestyle(self, curvestyle: str) -> bool:\n        return curvestyle.lower() in self.__curvestyles\n\n    def _validate_outformat(self, outformat: str) -> bool:\n        return outformat.lower() in self.__outformats\n\n    def node(self, nodeid: str, label: str, **attrs) -> None:\n        \"\"\"Create a new node.\"\"\"\n        self.dot.node(nodeid, label=label, **attrs)\n\n    def connect(self, node: \"Node\", node2: \"Node\", edge: \"Edge\") -> None:\n        \"\"\"Connect the two Nodes.\"\"\"\n        self.dot.edge(node.nodeid, node2.nodeid, **edge.attrs)\n\n    def subgraph(self, dot: Digraph) -> None:\n        \"\"\"Create a subgraph for clustering\"\"\"\n        self.dot.subgraph(dot)\n\n    def render(self) -> None:\n        if isinstance(self.outformat, list):\n            for one_format in self.outformat:\n                self.dot.render(format=one_format, view=self.show, quiet=True)\n        else:\n            self.dot.render(format=self.outformat, view=self.show, quiet=True)",
    "source": "github_repo:mingrammer/diagrams",
    "file": "diagrams/__init__.py",
    "license": "MIT",
    "language": "python"
}