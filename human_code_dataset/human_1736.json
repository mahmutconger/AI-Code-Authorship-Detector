{
    "code": "# -*- coding: utf-8 -*-\n\nimport asyncio\nimport os\nfrom random import randint\nimport sys\nfrom pprint import pprint\nimport time\n\nroot = os.path.dirname(os.path.dirname(os.path.dirname(os.path.dirname(os.path.abspath(__file__)))))\nsys.path.append(root + '/python')\n\nimport ccxt.async_support as ccxt  # noqa: E402\n\nprint('CCXT Version:', ccxt.__version__)\n\n####################################################################################\n# Simple arbitrage bot that will look for arbitrage opportunities on spot markets ##\n# and execute them using market orders.                                           ##\n#                                                                                 ##                 \n# Disclaimer: this bot is for educational purposes only. Use at your own risk.    ##\n####################################################################################\n\n# bot options\nwait_time = 5 # seconds to wait between each check\npaper_trading = True # set to false to actually execute trades\n\n# exchanges you want to use to look for arbitrage opportunities\nexchanges = [\n    ccxt.okx(),\n    ccxt.bybit({\"options\":{\"defaultType\":\"spot\"}}),\n    ccxt.binance(),\n    ccxt.kucoin(),\n    ccxt.bitmart(),\n    ccxt.gate()\n]\n\n# symbols you want to trade\nsymbols = [\n    \"BTC/USDT\",\n    \"LTC/USDT\",\n    \"DOGE/USDT\",\n    \"SHIB/USDT\",\n    \"SOL/USDT\",\n    \"ETH/USDT\",\n    \"ADA/USDT\",\n    \"DOT/USDT\",\n    \"UNI/USDT\",\n    \"LINK/USDT\",\n]\n\n# order sizes for each symbol, adjust it to your liking\norder_sizes = {\n    \"BTC/USDT\": 0.001,\n    \"LTC/USDT\": 0.01,\n    \"DOGE/USDT\": 100,\n    \"SHIB/USDT\": 1000000,\n    \"SOL/USDT\": 0.1,\n    \"ETH/USDT\": 0.01,\n    \"ADA/USDT\": 1,\n    \"DOT/USDT\": 0.1,\n    \"UNI/USDT\": 0.1,\n    \"LINK/USDT\": 0.1,\n}\n\nasync def get_last_prices():\n    tasks = [ exchange.fetch_tickers(symbols) for exchange in exchanges ]\n    results = await asyncio.gather(*tasks)\n    return results\n\nasync def bot():\n    prices = await get_last_prices()\n    for symbol in symbols:\n        ms = int(time.time() * 1000)\n\n        symbol_prices = [ exchange_prices[symbol]['last'] for exchange_prices in prices ]\n\n        min_price = min(symbol_prices)\n        max_price = max(symbol_prices)\n\n        order_size = order_sizes[symbol]\n\n        min_exchange = exchanges[symbol_prices.index(min_price)]\n        max_exchange = exchanges[symbol_prices.index(max_price)]\n\n        # calculate min exchange taker fee\n        # warning: you need to manually check if there are special campaign fees \n        min_exchange_fee = min_exchange.fees['trading']['taker']\n        min_fee = order_size * min_price * min_exchange_fee\n\n        # calculate max exchange taker fee\n        # warning: you need to manually check if there are special campaign fees \n        max_exchange_fee = max_exchange.fees['trading']['taker']\n        max_fee = order_size * max_price * max_exchange_fee\n\n        price_profit = max_price - min_price\n        profit = (price_profit * order_size) - (min_fee) - (max_fee)\n\n        if (profit > 0): # not taking into account slippage or order book depth\n            print(ms, symbol, \"profit:\", profit, \"Buy\", min_exchange.id, min_price, \"Sell\", max_exchange.id, max_price)\n            \n            if not paper_trading:\n                buy_min = min_exchange.create_market_buy_order(symbol, order_size)\n                sell_max = max_exchange.create_market_sell_order(symbol, order_size)\n                orders = await asyncio.gather(buy_min, sell_max) # execute them \"simultaneously\"\n                print(\"Orders executed successfully\")\n        else:\n            print(str(ms), symbol, \"no arbitrage opportunity\")\n\nasync def check_requirements():\n    print(\"Checking if exchanges support fetchTickers and the symbols we want to trade\")\n    for exchange in exchanges:\n        if not exchange.has['fetchTickers']:\n            print(exchange.id, \"does not support fetchTickers\")\n            sys.exit()\n        await exchange.load_markets()\n        \n        for symbol in symbols:\n            if symbol not in exchange.markets:\n                print(exchange.id, \"does not support\", symbol)\n                sys.exit()\n\nasync def main():\n    await check_requirements()\n    print(\"Starting bot\")\n    while True:\n        try:\n            await bot()\n        except e:\n            print(\"Exception: \", e)\n        await asyncio.sleep(wait_time)\n\nasyncio.run(main())",
    "source": "github_repo:ccxt/ccxt",
    "file": "examples/bots/py/spot-arbitrage-bot.py",
    "license": "MIT",
    "language": "python"
}