{
    "code": "def load_filter_patterns(filter_file: Path) -> dict[str, list[str]]:\n    \"\"\"Load all patterns from the changes-filter.yaml file.\n\n    Validates and normalizes the YAML structure to ensure it's a dict mapping\n    str to list[str]. Handles top-level \"filters\" key if present.\n    \"\"\"\n    with filter_file.open() as f:\n        data = yaml.safe_load(f)\n\n    # Handle empty or null file\n    if data is None:\n        return {}\n\n    # If there's a top-level \"filters\" key, use that instead\n    if isinstance(data, dict) and \"filters\" in data:\n        data = data[\"filters\"]\n\n    # Ensure we have a dict\n    if not isinstance(data, dict):\n        msg = f\"Expected dict at top level, got {type(data).__name__}\"\n        raise TypeError(msg)\n\n    # Normalize and validate the structure\n    result: dict[str, list[str]] = {}\n    for key, value in data.items():\n        # Validate key is a string\n        if not isinstance(key, str):\n            msg = f\"Expected string key, got {type(key).__name__}: {key}\"\n            raise TypeError(msg)\n\n        # Coerce single string to list\n        normalized_value = [value] if isinstance(value, str) else value\n\n        # Validate value is a list\n        if not isinstance(normalized_value, list):\n            msg = f\"Expected list for key '{key}', got {type(normalized_value).__name__}\"\n            raise TypeError(msg)\n\n        # Validate all items in the list are strings\n        for i, item in enumerate(normalized_value):\n            if not isinstance(item, str):\n                msg = f\"Expected string in list for key '{key}' at index {i}, got {type(item).__name__}\"\n                raise TypeError(msg)\n\n        result[key] = normalized_value\n\n    return result",
    "source": "github_repo:langflow-ai/langflow",
    "file": "scripts/check_changes_filter.py",
    "license": "MIT",
    "language": "python"
}