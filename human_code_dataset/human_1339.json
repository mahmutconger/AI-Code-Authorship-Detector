{
    "code": "def generate_mermaid_diagram(nodes: List[Dict], connections: Dict) -> str:\n    \"\"\"Generate Mermaid.js flowchart code from workflow nodes and connections.\"\"\"\n    if not nodes:\n        return \"graph TD\\n  EmptyWorkflow[No nodes found in workflow]\"\n    \n    # Create mapping for node names to ensure valid mermaid IDs\n    mermaid_ids = {}\n    for i, node in enumerate(nodes):\n        node_id = f\"node{i}\"\n        node_name = node.get('name', f'Node {i}')\n        mermaid_ids[node_name] = node_id\n    \n    # Start building the mermaid diagram\n    mermaid_code = [\"graph TD\"]\n    \n    # Add nodes with styling\n    for node in nodes:\n        node_name = node.get('name', 'Unnamed')\n        node_id = mermaid_ids[node_name]\n        node_type = node.get('type', '').replace('n8n-nodes-base.', '')\n        \n        # Determine node style based on type\n        style = \"\"\n        if any(x in node_type.lower() for x in ['trigger', 'webhook', 'cron']):\n            style = \"fill:#b3e0ff,stroke:#0066cc\"  # Blue for triggers\n        elif any(x in node_type.lower() for x in ['if', 'switch']):\n            style = \"fill:#ffffb3,stroke:#e6e600\"  # Yellow for conditional nodes\n        elif any(x in node_type.lower() for x in ['function', 'code']):\n            style = \"fill:#d9b3ff,stroke:#6600cc\"  # Purple for code nodes\n        elif 'error' in node_type.lower():\n            style = \"fill:#ffb3b3,stroke:#cc0000\"  # Red for error handlers\n        else:\n            style = \"fill:#d9d9d9,stroke:#666666\"  # Gray for other nodes\n        \n        # Add node with label (escaping special characters)\n        clean_name = node_name.replace('\"', \"'\")\n        clean_type = node_type.replace('\"', \"'\")\n        label = f\"{clean_name}<br>({clean_type})\"\n        mermaid_code.append(f\"  {node_id}[\\\"{label}\\\"]\")\n        mermaid_code.append(f\"  style {node_id} {style}\")\n    \n    # Add connections between nodes\n    for source_name, source_connections in connections.items():\n        if source_name not in mermaid_ids:\n            continue\n        \n        if isinstance(source_connections, dict) and 'main' in source_connections:\n            main_connections = source_connections['main']\n            \n            for i, output_connections in enumerate(main_connections):\n                if not isinstance(output_connections, list):\n                    continue\n                    \n                for connection in output_connections:\n                    if not isinstance(connection, dict) or 'node' not in connection:\n                        continue\n                        \n                    target_name = connection['node']\n                    if target_name not in mermaid_ids:\n                        continue\n                        \n                    # Add arrow with output index if multiple outputs\n                    label = f\" -->|{i}| \" if len(main_connections) > 1 else \" --> \"\n                    mermaid_code.append(f\"  {mermaid_ids[source_name]}{label}{mermaid_ids[target_name]}\")\n    \n    # Format the final mermaid diagram code\n    return \"\\n\".join(mermaid_code)",
    "source": "github_repo:Zie619/n8n-workflows",
    "file": "api_server.py",
    "license": "MIT",
    "language": "python"
}