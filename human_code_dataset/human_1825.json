{
    "code": "def find_largest_model(checkpoint_dir):\n    # attempt to guess the model tag: take the biggest model available\n    model_tags = [f for f in os.listdir(checkpoint_dir) if os.path.isdir(os.path.join(checkpoint_dir, f))]\n    if not model_tags:\n        raise FileNotFoundError(f\"No checkpoints found in {checkpoint_dir}\")\n    # 1) normally all model tags are of the form d<number>, try that first:\n    candidates = []\n    for model_tag in model_tags:\n        match = re.match(r\"d(\\d+)\", model_tag)\n        if match:\n            model_depth = int(match.group(1))\n            candidates.append((model_depth, model_tag))\n    if candidates:\n        candidates.sort(key=lambda x: x[0], reverse=True)\n        return candidates[0][1]\n    # 2) if that failed, take the most recently updated model:\n    model_tags.sort(key=lambda x: os.path.getmtime(os.path.join(checkpoint_dir, x)), reverse=True)\n    return model_tags[0]",
    "source": "github_repo:karpathy/nanochat",
    "file": "nanochat/checkpoint_manager.py",
    "license": "MIT",
    "language": "python"
}