{
    "code": "def __init__(\n        self,\n        channels,\n        out_channels,\n        n_heads,\n        p_dropout=0.0,\n        window_size=None,\n        heads_share=True,\n        block_length=None,\n        proximal_bias=False,\n        proximal_init=False,\n    ):\n        super().__init__()\n        assert channels % n_heads == 0\n\n        self.channels = channels\n        self.out_channels = out_channels\n        self.n_heads = n_heads\n        self.p_dropout = p_dropout\n        self.window_size = window_size\n        self.heads_share = heads_share\n        self.block_length = block_length\n        self.proximal_bias = proximal_bias\n        self.proximal_init = proximal_init\n        self.attn = None\n\n        self.k_channels = channels // n_heads\n        self.conv_q = nn.Conv1d(channels, channels, 1)\n        self.conv_k = nn.Conv1d(channels, channels, 1)\n        self.conv_v = nn.Conv1d(channels, channels, 1)\n        self.conv_o = nn.Conv1d(channels, out_channels, 1)\n        self.drop = nn.Dropout(p_dropout)\n\n        if window_size is not None:\n            n_heads_rel = 1 if heads_share else n_heads\n            rel_stddev = self.k_channels**-0.5\n            self.emb_rel_k = nn.Parameter(\n                torch.randn(n_heads_rel, window_size * 2 + 1, self.k_channels)\n                * rel_stddev\n            )\n            self.emb_rel_v = nn.Parameter(\n                torch.randn(n_heads_rel, window_size * 2 + 1, self.k_channels)\n                * rel_stddev\n            )\n\n        nn.init.xavier_uniform_(self.conv_q.weight)\n        nn.init.xavier_uniform_(self.conv_k.weight)\n        nn.init.xavier_uniform_(self.conv_v.weight)\n        if proximal_init:\n            with torch.no_grad():\n                self.conv_k.weight.copy_(self.conv_q.weight)\n                self.conv_k.bias.copy_(self.conv_q.bias)",
    "source": "github_repo:myshell-ai/OpenVoice",
    "file": "openvoice/attentions.py",
    "license": "MIT",
    "language": "python"
}