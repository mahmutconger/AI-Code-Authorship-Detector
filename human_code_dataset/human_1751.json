{
    "code": "# -*- coding: utf-8 -*-\n\nfrom asyncio import run, gather\nimport os\nimport sys\n\nroot = os.path.dirname(os.path.dirname(os.path.dirname(os.path.abspath(__file__))))\nsys.path.append(root + '/python')\n\nimport ccxt.pro  # noqa: E402\n\n\nprint('CCXT Version:', ccxt.__version__)\n\n\nasync def print_balance_continuously(exchange):\n    while True:\n        try:\n            print('-----------------------------------------------------------')\n            await exchange.load_markets()\n            balance = await exchange.watch_balance()\n            print(exchange.iso8601(exchange.milliseconds()), exchange.id)\n            for currency, value in balance['total'].items():\n                print(value, currency)\n        except Exception as e:\n            print('-----------------------------------------------------------')\n            print(exchange.iso8601(exchange.milliseconds()), exchange.id, type(e), e)\n            await exchange.sleep(300000)  # sleep 5 minutes and retry\n\n\nasync def main():\n    config = {\n        'apiKey': 'YOUR_API_KEY',\n        'secret': 'YOUR_SECRET',\n    }\n    exchange_ids = [\n        'binance',\n        'binanceusdm',\n        'binancecoinm',\n    ]\n    exchanges = [getattr(ccxt.pro, exchange_id)(config) for exchange_id in exchange_ids]\n    printing_loops = [print_balance_continuously(exchange) for exchange in exchanges]\n    await gather(*printing_loops)\n    closing_tasks = [exchange.close() for exchange in exchanges]\n    await gather(*closing_tasks)\n\n\nrun(main())",
    "source": "github_repo:ccxt/ccxt",
    "file": "examples/ccxt.pro/py/binance-watch-spot-futures-balances-continuously.py",
    "license": "MIT",
    "language": "python"
}