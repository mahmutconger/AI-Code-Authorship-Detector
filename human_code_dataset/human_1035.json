{
    "code": "def __init__(\n        self,\n        dataset: Dataset,\n        num_replicas: Optional[int] = None,\n        rank: Optional[int] = None,\n        shuffle: bool = True,\n        seed: int = 0,\n        drop_last: bool = False,\n        batch_size: int = 32,\n    ) -> None:\n        if num_replicas is None:\n            if not dist.is_available():\n                raise RuntimeError(\"Requires distributed package to be available\")\n            num_replicas = dist.get_world_size() if torch.cuda.is_available() else 1\n        if rank is None:\n            if not dist.is_available():\n                raise RuntimeError(\"Requires distributed package to be available\")\n            rank = dist.get_rank() if torch.cuda.is_available() else 0\n            if torch.cuda.is_available():\n                torch.cuda.set_device(rank)\n        if rank >= num_replicas or rank < 0:\n            raise ValueError(\"Invalid rank {}, rank should be in the interval [0, {}]\".format(rank, num_replicas - 1))\n        self.dataset = dataset\n        self.num_replicas = num_replicas\n        self.rank = rank\n        self.epoch = 0\n        self.drop_last = drop_last\n        # If the dataset length is evenly divisible by # of replicas, then there\n        # is no need to drop any data, since the dataset will be split equally.\n        if self.drop_last and len(self.dataset) % self.num_replicas != 0:  # type: ignore[arg-type]\n            # Split to nearest available length that is evenly divisible.\n            # This is to ensure each rank receives the same amount of data when\n            # using this Sampler.\n            self.num_samples = math.ceil(\n                (len(self.dataset) - self.num_replicas) / self.num_replicas,  # type: ignore[arg-type]\n            )\n        else:\n            self.num_samples = math.ceil(\n                len(self.dataset) / self.num_replicas,\n            )  # type: ignore[arg-type]\n        self.total_size = self.num_samples * self.num_replicas\n        self.shuffle = shuffle\n        self.seed = seed\n        self.batch_size = batch_size\n        self.id_with_length = self._get_sample_lengths()\n        self.id_buckets = self.make_buckets(bucket_width=2.0)",
    "source": "github_repo:RVC-Boss/GPT-SoVITS",
    "file": "GPT_SoVITS/AR/data/bucket_sampler.py",
    "license": "MIT",
    "language": "python"
}