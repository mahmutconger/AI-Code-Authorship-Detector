{
    "code": "def reply(self, query, context=None):\n        # acquire reply content\n        if context and context.type:\n            if context.type == ContextType.TEXT:\n                logger.info(\"[BAIDU] query={}\".format(query))\n                session_id = context[\"session_id\"]\n                reply = None\n                if query == \"#清除记忆\":\n                    self.sessions.clear_session(session_id)\n                    reply = Reply(ReplyType.INFO, \"记忆已清除\")\n                elif query == \"#清除所有\":\n                    self.sessions.clear_all_session()\n                    reply = Reply(ReplyType.INFO, \"所有人记忆已清除\")\n                else:\n                    session = self.sessions.session_query(query, session_id)\n                    result = self.reply_text(session)\n                    total_tokens, completion_tokens, reply_content = (\n                        result[\"total_tokens\"],\n                        result[\"completion_tokens\"],\n                        result[\"content\"],\n                    )\n                    logger.debug(\n                        \"[BAIDU] new_query={}, session_id={}, reply_cont={}, completion_tokens={}\".format(session.messages, session_id, reply_content, completion_tokens)\n                    )\n\n                    if total_tokens == 0:\n                        reply = Reply(ReplyType.ERROR, reply_content)\n                    else:\n                        self.sessions.session_reply(reply_content, session_id, total_tokens)\n                        reply = Reply(ReplyType.TEXT, reply_content)\n                return reply\n            elif context.type == ContextType.IMAGE_CREATE:\n                ok, retstring = self.create_img(query, 0)\n                reply = None\n                if ok:\n                    reply = Reply(ReplyType.IMAGE_URL, retstring)\n                else:\n                    reply = Reply(ReplyType.ERROR, retstring)\n                return reply",
    "source": "github_repo:zhayujie/chatgpt-on-wechat",
    "file": "bot/baidu/baidu_wenxin.py",
    "license": "MIT",
    "language": "python"
}