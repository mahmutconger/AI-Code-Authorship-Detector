{
    "code": "def comment_details(run_id: str) -> None:\n    data = http_get(f\"https://api.github.com/repos/{REPO}/actions/runs/{run_id}\")\n    if data[\"event\"] != \"pull_request\" or data[\"conclusion\"] == \"cancelled\":\n        set_output(\"needs-comment\", \"false\")\n        return\n\n    set_output(\"needs-comment\", \"true\")\n    jobs = http_get(data[\"jobs_url\"])[\"jobs\"]\n    job = next(j for j in jobs if j[\"name\"] == \"compare / preview-new-changes\")\n    diff_step = next(s for s in job[\"steps\"] if s[\"name\"] == DIFF_STEP_NAME)\n    diff_url = job[\"html_url\"] + f\"#step:{diff_step['number']}:1\"\n\n    artifacts = http_get(data[\"artifacts_url\"])[\"artifacts\"]\n    comment_artifact = next(a for a in artifacts if a[\"name\"] == COMMENT_FILE)\n    comment_url = comment_artifact[\"archive_download_url\"]\n    comment_zip = BytesIO(http_get(comment_url, is_json=False))\n    with zipfile.ZipFile(comment_zip) as zfile:\n        with zfile.open(COMMENT_FILE) as rf:\n            comment_data = json.loads(rf.read().decode(\"utf-8\"))\n\n    set_output(\"pr-number\", str(comment_data[\"pr-number\"]))\n    body = comment_data[\"body\"]\n    # It's more convenient to fill in these fields after the first workflow is done\n    # since this command can access the workflows API (doing it in the main workflow\n    # while it's still in progress seems impossible).\n    body = body.replace(\"$workflow-run-url\", data[\"html_url\"])\n    body = body.replace(\"$job-diff-url\", diff_url)\n    set_output(\"comment-body\", body)",
    "source": "github_repo:psf/black",
    "file": "scripts/diff_shades_gha_helper.py",
    "license": "MIT",
    "language": "python"
}