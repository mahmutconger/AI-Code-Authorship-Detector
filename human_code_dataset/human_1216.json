{
    "code": "class TaskManager:\n    def __init__(self, max_concurrent_tasks: int):\n        self.max_concurrent_tasks = max_concurrent_tasks\n        self.current_tasks = 0\n        self.lock = threading.Lock()\n        self.queue = self.create_queue()\n\n    def create_queue(self):\n        raise NotImplementedError()\n\n    def add_task(self, func: Callable, *args: Any, **kwargs: Any):\n        with self.lock:\n            if self.current_tasks < self.max_concurrent_tasks:\n                print(f\"add task: {func.__name__}, current_tasks: {self.current_tasks}\")\n                self.execute_task(func, *args, **kwargs)\n            else:\n                print(\n                    f\"enqueue task: {func.__name__}, current_tasks: {self.current_tasks}\"\n                )\n                self.enqueue({\"func\": func, \"args\": args, \"kwargs\": kwargs})\n\n    def execute_task(self, func: Callable, *args: Any, **kwargs: Any):\n        thread = threading.Thread(\n            target=self.run_task, args=(func, *args), kwargs=kwargs\n        )\n        thread.start()\n\n    def run_task(self, func: Callable, *args: Any, **kwargs: Any):\n        try:\n            with self.lock:\n                self.current_tasks += 1\n            func(*args, **kwargs)  # call the function here, passing *args and **kwargs.\n        finally:\n            self.task_done()\n\n    def check_queue(self):\n        with self.lock:\n            if (\n                self.current_tasks < self.max_concurrent_tasks\n                and not self.is_queue_empty()\n            ):\n                task_info = self.dequeue()\n                func = task_info[\"func\"]\n                args = task_info.get(\"args\", ())\n                kwargs = task_info.get(\"kwargs\", {})\n                self.execute_task(func, *args, **kwargs)\n\n    def task_done(self):\n        with self.lock:\n            self.current_tasks -= 1\n        self.check_queue()\n\n    def enqueue(self, task: Dict):\n        raise NotImplementedError()\n\n    def dequeue(self):\n        raise NotImplementedError()\n\n    def is_queue_empty(self):\n        raise NotImplementedError()",
    "source": "github_repo:harry0703/MoneyPrinterTurbo",
    "file": "app/controllers/manager/base_manager.py",
    "license": "MIT",
    "language": "python"
}