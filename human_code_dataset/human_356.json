{
    "code": "def test_median_filter(shape):\n    x = torch.randn(*shape)\n\n    for filter_width in [3, 5, 7, 13]:\n        filtered = median_filter(x, filter_width)\n\n        # using np.pad to reflect-pad, because Scipy's behavior is different near the edges.\n        pad_width = filter_width // 2\n        padded_x = np.pad(\n            x, [(0, 0)] * (x.ndim - 1) + [(pad_width, pad_width)], mode=\"reflect\"\n        )\n        scipy_filtered = scipy.ndimage.median_filter(\n            padded_x, [1] * (x.ndim - 1) + [filter_width]\n        )\n        scipy_filtered = scipy_filtered[..., pad_width:-pad_width]\n\n        assert np.allclose(filtered, scipy_filtered)",
    "source": "github_repo:openai/whisper",
    "file": "tests/test_timing.py",
    "license": "MIT",
    "language": "python"
}