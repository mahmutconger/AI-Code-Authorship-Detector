{
    "code": "def ask_for_files(self, skip_file_selection=False) -> tuple[FilesDict, bool]:\n        \"\"\"\n        Prompts the user to select files for context improvement.\n\n        This method supports selection from the terminal or using a previously saved list.\n        In test mode, it retrieves files from a predefined TOML configuration.\n\n        Returns\n        -------\n        FilesDict\n            A dictionary with file paths as keys and file contents as values.\n        \"\"\"\n\n        if os.getenv(\"GPTE_TEST_MODE\") or skip_file_selection:\n            # In test mode, retrieve files from a predefined TOML configuration\n            # also get from toml if skip_file_selector is active\n            assert self.FILE_LIST_NAME in self.metadata_db\n            selected_files = self.get_files_from_toml(self.project_path, self.toml_path)\n        else:\n            # Otherwise, use the editor file selector for interactive selection\n            if self.FILE_LIST_NAME in self.metadata_db:\n                print(\n                    f\"File list detected at {self.toml_path}. Edit or delete it if you want to select new files.\"\n                )\n                selected_files = self.editor_file_selector(self.project_path, False)\n            else:\n                selected_files = self.editor_file_selector(self.project_path, True)\n\n        content_dict = {}\n        for file_path in selected_files:\n            # selected files contains paths that are relative to the project path\n            try:\n                # to open the file we need the path from the cwd\n                with open(\n                    Path(self.project_path) / file_path, \"r\", encoding=\"utf-8\"\n                ) as content:\n                    content_dict[str(file_path)] = content.read()\n            except FileNotFoundError:\n                print(f\"Warning: File not found {file_path}\")\n            except UnicodeDecodeError:\n                print(f\"Warning: File not UTF-8 encoded {file_path}, skipping\")\n\n        return FilesDict(content_dict), self.is_linting",
    "source": "github_repo:AntonOsika/gpt-engineer",
    "file": "gpt_engineer/applications/cli/file_selector.py",
    "license": "MIT",
    "language": "python"
}