{
    "code": "class QueryNotifyPrint(QueryNotify):\n    \"\"\"Query Notify Print Object.\n\n    Query notify class that prints results.\n    \"\"\"\n\n    def __init__(self, result=None, verbose=False, print_all=False, browse=False):\n        \"\"\"Create Query Notify Print Object.\n\n        Contains information about a specific method of notifying the results\n        of a query.\n\n        Keyword Arguments:\n        self                   -- This object.\n        result                 -- Object of type QueryResult() containing\n                                  results for this query.\n        verbose                -- Boolean indicating whether to give verbose output.\n        print_all              -- Boolean indicating whether to only print all sites, including not found.\n        browse                 -- Boolean indicating whether to open found sites in a web browser.\n\n        Return Value:\n        Nothing.\n        \"\"\"\n\n        super().__init__(result)\n        self.verbose = verbose\n        self.print_all = print_all\n        self.browse = browse\n\n        return\n\n    def start(self, message):\n        \"\"\"Notify Start.\n\n        Will print the title to the standard output.\n\n        Keyword Arguments:\n        self                   -- This object.\n        message                -- String containing username that the series\n                                  of queries are about.\n\n        Return Value:\n        Nothing.\n        \"\"\"\n\n        title = \"Checking username\"\n\n        print(Style.BRIGHT + Fore.GREEN + \"[\" +\n              Fore.YELLOW + \"*\" +\n              Fore.GREEN + f\"] {title}\" +\n              Fore.WHITE + f\" {message}\" +\n              Fore.GREEN + \" on:\")\n        # An empty line between first line and the result(more clear output)\n        print('\\r')\n\n        return\n\n    def countResults(self):\n        \"\"\"This function counts the number of results. Every time the function is called,\n        the number of results is increasing.\n\n        Keyword Arguments:\n        self                   -- This object.\n\n        Return Value:\n        The number of results by the time we call the function.\n        \"\"\"\n        global globvar\n        globvar += 1\n        return globvar\n\n    def update(self, result):\n        \"\"\"Notify Update.\n\n        Will print the query result to the standard output.\n\n        Keyword Arguments:\n        self                   -- This object.\n        result                 -- Object of type QueryResult() containing\n                                  results for this query.\n\n        Return Value:\n        Nothing.\n        \"\"\"\n        self.result = result\n\n        response_time_text = \"\"\n        if self.result.query_time is not None and self.verbose is True:\n            response_time_text = f\" [{round(self.result.query_time * 1000)}ms]\"\n\n        # Output to the terminal is desired.\n        if result.status == QueryStatus.CLAIMED:\n            self.countResults()\n            print(Style.BRIGHT + Fore.WHITE + \"[\" +\n                  Fore.GREEN + \"+\" +\n                  Fore.WHITE + \"]\" +\n                  response_time_text +\n                  Fore.GREEN +\n                  f\" {self.result.site_name}: \" +\n                  Style.RESET_ALL +\n                  f\"{self.result.site_url_user}\")\n            if self.browse:\n                webbrowser.open(self.result.site_url_user, 2)\n\n        elif result.status == QueryStatus.AVAILABLE:\n            if self.print_all:\n                print(Style.BRIGHT + Fore.WHITE + \"[\" +\n                      Fore.RED + \"-\" +\n                      Fore.WHITE + \"]\" +\n                      response_time_text +\n                      Fore.GREEN + f\" {self.result.site_name}:\" +\n                      Fore.YELLOW + \" Not Found!\")\n\n        elif result.status == QueryStatus.UNKNOWN:\n            if self.print_all:\n                print(Style.BRIGHT + Fore.WHITE + \"[\" +\n                      Fore.RED + \"-\" +\n                      Fore.WHITE + \"]\" +\n                      Fore.GREEN + f\" {self.result.site_name}:\" +\n                      Fore.RED + f\" {self.result.context}\" +\n                      Fore.YELLOW + \" \")\n\n        elif result.status == QueryStatus.ILLEGAL:\n            if self.print_all:\n                msg = \"Illegal Username Format For This Site!\"\n                print(Style.BRIGHT + Fore.WHITE + \"[\" +\n                      Fore.RED + \"-\" +\n                      Fore.WHITE + \"]\" +\n                      Fore.GREEN + f\" {self.result.site_name}:\" +\n                      Fore.YELLOW + f\" {msg}\")\n                \n        elif result.status == QueryStatus.WAF:\n            if self.print_all:\n                print(Style.BRIGHT + Fore.WHITE + \"[\" +\n                      Fore.RED + \"-\" +\n                      Fore.WHITE + \"]\" +\n                      Fore.GREEN + f\" {self.result.site_name}:\" +\n                      Fore.RED + \" Blocked by bot detection\" +\n                      Fore.YELLOW + \" (proxy may help)\")\n\n        else:\n            # It should be impossible to ever get here...\n            raise ValueError(\n                f\"Unknown Query Status '{result.status}' for site '{self.result.site_name}'\"\n            )\n\n        return\n\n    def finish(self, message=\"The processing has been finished.\"):\n        \"\"\"Notify Start.\n        Will print the last line to the standard output.\n        Keyword Arguments:\n        self                   -- This object.\n        message                -- The 2 last phrases.\n        Return Value:\n        Nothing.\n        \"\"\"\n        NumberOfResults = self.countResults() - 1\n\n        print(Style.BRIGHT + Fore.GREEN + \"[\" +\n              Fore.YELLOW + \"*\" +\n              Fore.GREEN + \"] Search completed with\" +\n              Fore.WHITE + f\" {NumberOfResults} \" +\n              Fore.GREEN + \"results\" + Style.RESET_ALL\n              )\n\n    def __str__(self):\n        \"\"\"Convert Object To String.\n\n        Keyword Arguments:\n        self                   -- This object.\n\n        Return Value:\n        Nicely formatted string to get information about this object.\n        \"\"\"\n        return str(self.result)",
    "source": "github_repo:sherlock-project/sherlock",
    "file": "sherlock_project/notify.py",
    "license": "MIT",
    "language": "python"
}