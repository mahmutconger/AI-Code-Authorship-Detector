{
    "code": "class Mouse:\n\t\"\"\"Mouse operations for a target.\"\"\"\n\n\tdef __init__(self, browser_session: 'BrowserSession', session_id: str | None = None, target_id: str | None = None):\n\t\tself._browser_session = browser_session\n\t\tself._client = browser_session.cdp_client\n\t\tself._session_id = session_id\n\t\tself._target_id = target_id\n\n\tasync def click(self, x: int, y: int, button: 'MouseButton' = 'left', click_count: int = 1) -> None:\n\t\t\"\"\"Click at the specified coordinates.\"\"\"\n\t\t# Mouse press\n\t\tpress_params: 'DispatchMouseEventParameters' = {\n\t\t\t'type': 'mousePressed',\n\t\t\t'x': x,\n\t\t\t'y': y,\n\t\t\t'button': button,\n\t\t\t'clickCount': click_count,\n\t\t}\n\t\tawait self._client.send.Input.dispatchMouseEvent(\n\t\t\tpress_params,\n\t\t\tsession_id=self._session_id,\n\t\t)\n\n\t\t# Mouse release\n\t\trelease_params: 'DispatchMouseEventParameters' = {\n\t\t\t'type': 'mouseReleased',\n\t\t\t'x': x,\n\t\t\t'y': y,\n\t\t\t'button': button,\n\t\t\t'clickCount': click_count,\n\t\t}\n\t\tawait self._client.send.Input.dispatchMouseEvent(\n\t\t\trelease_params,\n\t\t\tsession_id=self._session_id,\n\t\t)\n\n\tasync def down(self, button: 'MouseButton' = 'left', click_count: int = 1) -> None:\n\t\t\"\"\"Press mouse button down.\"\"\"\n\t\tparams: 'DispatchMouseEventParameters' = {\n\t\t\t'type': 'mousePressed',\n\t\t\t'x': 0,  # Will use last mouse position\n\t\t\t'y': 0,\n\t\t\t'button': button,\n\t\t\t'clickCount': click_count,\n\t\t}\n\t\tawait self._client.send.Input.dispatchMouseEvent(\n\t\t\tparams,\n\t\t\tsession_id=self._session_id,\n\t\t)\n\n\tasync def up(self, button: 'MouseButton' = 'left', click_count: int = 1) -> None:\n\t\t\"\"\"Release mouse button.\"\"\"\n\t\tparams: 'DispatchMouseEventParameters' = {\n\t\t\t'type': 'mouseReleased',\n\t\t\t'x': 0,  # Will use last mouse position\n\t\t\t'y': 0,\n\t\t\t'button': button,\n\t\t\t'clickCount': click_count,\n\t\t}\n\t\tawait self._client.send.Input.dispatchMouseEvent(\n\t\t\tparams,\n\t\t\tsession_id=self._session_id,\n\t\t)\n\n\tasync def move(self, x: int, y: int, steps: int = 1) -> None:\n\t\t\"\"\"Move mouse to the specified coordinates.\"\"\"\n\t\t# TODO: Implement smooth movement with multiple steps if needed\n\t\t_ = steps  # Acknowledge parameter for future use\n\n\t\tparams: 'DispatchMouseEventParameters' = {'type': 'mouseMoved', 'x': x, 'y': y}\n\t\tawait self._client.send.Input.dispatchMouseEvent(params, session_id=self._session_id)\n\n\tasync def scroll(self, x: int = 0, y: int = 0, delta_x: int | None = None, delta_y: int | None = None) -> None:\n\t\t\"\"\"Scroll the page using robust CDP methods.\"\"\"\n\t\tif not self._session_id:\n\t\t\traise RuntimeError('Session ID is required for scroll operations')\n\n\t\t# Method 1: Try mouse wheel event (most reliable)\n\t\ttry:\n\t\t\t# Get viewport dimensions\n\t\t\tlayout_metrics = await self._client.send.Page.getLayoutMetrics(session_id=self._session_id)\n\t\t\tviewport_width = layout_metrics['layoutViewport']['clientWidth']\n\t\t\tviewport_height = layout_metrics['layoutViewport']['clientHeight']\n\n\t\t\t# Use provided coordinates or center of viewport\n\t\t\tscroll_x = x if x > 0 else viewport_width / 2\n\t\t\tscroll_y = y if y > 0 else viewport_height / 2\n\n\t\t\t# Calculate scroll deltas (positive = down/right)\n\t\t\tscroll_delta_x = delta_x or 0\n\t\t\tscroll_delta_y = delta_y or 0\n\n\t\t\t# Dispatch mouse wheel event\n\t\t\tawait self._client.send.Input.dispatchMouseEvent(\n\t\t\t\tparams={\n\t\t\t\t\t'type': 'mouseWheel',\n\t\t\t\t\t'x': scroll_x,\n\t\t\t\t\t'y': scroll_y,\n\t\t\t\t\t'deltaX': scroll_delta_x,\n\t\t\t\t\t'deltaY': scroll_delta_y,\n\t\t\t\t},\n\t\t\t\tsession_id=self._session_id,\n\t\t\t)\n\t\t\treturn\n\n\t\texcept Exception:\n\t\t\tpass\n\n\t\t# Method 2: Fallback to synthesizeScrollGesture\n\t\ttry:\n\t\t\tparams: 'SynthesizeScrollGestureParameters' = {'x': x, 'y': y, 'xDistance': delta_x or 0, 'yDistance': delta_y or 0}\n\t\t\tawait self._client.send.Input.synthesizeScrollGesture(\n\t\t\t\tparams,\n\t\t\t\tsession_id=self._session_id,\n\t\t\t)\n\t\texcept Exception:\n\t\t\t# Method 3: JavaScript fallback\n\t\t\tscroll_js = f'window.scrollBy({delta_x or 0}, {delta_y or 0})'\n\t\t\tawait self._client.send.Runtime.evaluate(\n\t\t\t\tparams={'expression': scroll_js, 'returnByValue': True},\n\t\t\t\tsession_id=self._session_id,\n\t\t\t)",
    "source": "github_repo:browser-use/browser-use",
    "file": "browser_use/actor/mouse.py",
    "license": "MIT",
    "language": "python"
}