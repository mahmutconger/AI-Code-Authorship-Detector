{
    "code": "def read_version_specifier_from_pyproject() -> str:\n    if sys.version_info < (3, 11):\n        print(\n            \"::error::'with.use_pyproject' input requires Python 3.11 or later.\",\n            file=sys.stderr,\n            flush=True,\n        )\n        sys.exit(1)\n\n    import tomllib  # type: ignore[import-not-found,unreachable]\n\n    try:\n        with Path(\"pyproject.toml\").open(\"rb\") as fp:\n            pyproject = tomllib.load(fp)\n    except FileNotFoundError:\n        print(\n            \"::error::'with.use_pyproject' input requires a pyproject.toml file.\",\n            file=sys.stderr,\n            flush=True,\n        )\n        sys.exit(1)\n\n    version = pyproject.get(\"tool\", {}).get(\"black\", {}).get(\"required-version\")\n    if version is not None:\n        # Match the two supported usages of `required-version`:\n        if \".\" in version:\n            return f\"=={version}\"\n        else:\n            return f\"~={version}.0\"\n\n    arrays = [\n        *pyproject.get(\"dependency-groups\", {}).values(),\n        pyproject.get(\"project\", {}).get(\"dependencies\"),\n        *pyproject.get(\"project\", {}).get(\"optional-dependencies\", {}).values(),\n    ]\n    for array in arrays:\n        version = find_black_version_in_array(array)\n        if version is not None:\n            break\n\n    if version is None:\n        print(\n            \"::error::'black' dependency missing from pyproject.toml.\",\n            file=sys.stderr,\n            flush=True,\n        )\n        sys.exit(1)\n\n    return version",
    "source": "github_repo:psf/black",
    "file": "action/main.py",
    "license": "MIT",
    "language": "python"
}