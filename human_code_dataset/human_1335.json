{
    "code": "def validate_filename(filename: str) -> bool:\n    \"\"\"\n    Validate filename to prevent path traversal attacks.\n    Returns True if filename is safe, False otherwise.\n    \"\"\"\n    # Decode URL encoding multiple times to catch encoded traversal attempts\n    decoded = filename\n    for _ in range(3):  # Decode up to 3 times to catch nested encodings\n        try:\n            decoded = urllib.parse.unquote(decoded, errors='strict')\n        except:\n            return False  # Invalid encoding\n\n    # Check for path traversal patterns\n    dangerous_patterns = [\n        '..',  # Parent directory\n        '..\\\\',  # Windows parent directory\n        '../',  # Unix parent directory\n        '\\\\',  # Backslash (Windows path separator)\n        '/',  # Forward slash (Unix path separator)\n        '\\x00',  # Null byte\n        '\\n', '\\r',  # Newlines\n        '~',  # Home directory\n        ':',  # Drive letter or stream (Windows)\n        '|', '<', '>',  # Shell redirection\n        '*', '?',  # Wildcards\n        '$',  # Variable expansion\n        ';', '&',  # Command separators\n    ]\n\n    for pattern in dangerous_patterns:\n        if pattern in decoded:\n            return False\n\n    # Check for absolute paths\n    if decoded.startswith('/') or decoded.startswith('\\\\'):\n        return False\n\n    # Check for Windows drive letters\n    if len(decoded) >= 2 and decoded[1] == ':':\n        return False\n\n    # Only allow alphanumeric, dash, underscore, and .json extension\n    if not re.match(r'^[a-zA-Z0-9_\\-]+\\.json$', decoded):\n        return False\n\n    # Additional check: filename should end with .json\n    if not decoded.endswith('.json'):\n        return False\n\n    return True",
    "source": "github_repo:Zie619/n8n-workflows",
    "file": "api_server.py",
    "license": "MIT",
    "language": "python"
}