{
    "code": "class CreateAgentOutputFileEvent(BaseEvent):\n\t# Model fields\n\tid: str = Field(default_factory=uuid7str)\n\tuser_id: str = Field(max_length=255)\n\tdevice_id: str | None = Field(None, max_length=255)  # Device ID for auth lookup\n\ttask_id: str\n\tfile_name: str = Field(max_length=255)\n\tfile_content: str | None = None  # Base64 encoded file content\n\tcontent_type: str | None = Field(None, max_length=100)  # MIME type for file uploads\n\tcreated_at: datetime = Field(default_factory=lambda: datetime.now(timezone.utc))\n\n\t@field_validator('file_content')\n\t@classmethod\n\tdef validate_file_size(cls, v: str | None) -> str | None:\n\t\t\"\"\"Validate base64 file content size.\"\"\"\n\t\tif v is None:\n\t\t\treturn v\n\t\t# Remove data URL prefix if present\n\t\tif ',' in v:\n\t\t\tv = v.split(',')[1]\n\t\t# Estimate decoded size (base64 is ~33% larger)\n\t\testimated_size = len(v) * 3 / 4\n\t\tif estimated_size > MAX_FILE_CONTENT_SIZE:\n\t\t\traise ValueError(f'File content exceeds maximum size of {MAX_FILE_CONTENT_SIZE / 1024 / 1024}MB')\n\t\treturn v\n\n\t@classmethod\n\tasync def from_agent_and_file(cls, agent, output_path: str) -> 'CreateAgentOutputFileEvent':\n\t\t\"\"\"Create a CreateAgentOutputFileEvent from a file path\"\"\"\n\n\t\tgif_path = Path(output_path)\n\t\tif not gif_path.exists():\n\t\t\traise FileNotFoundError(f'File not found: {output_path}')\n\n\t\tgif_size = os.path.getsize(gif_path)\n\n\t\t# Read GIF content for base64 encoding if needed\n\t\tgif_content = None\n\t\tif gif_size < 50 * 1024 * 1024:  # Only read if < 50MB\n\t\t\tasync with await anyio.open_file(gif_path, 'rb') as f:\n\t\t\t\tgif_bytes = await f.read()\n\t\t\t\tgif_content = base64.b64encode(gif_bytes).decode('utf-8')\n\n\t\treturn cls(\n\t\t\tuser_id='',  # To be filled by cloud handler\n\t\t\tdevice_id=agent.cloud_sync.auth_client.device_id\n\t\t\tif hasattr(agent, 'cloud_sync') and agent.cloud_sync and agent.cloud_sync.auth_client\n\t\t\telse None,\n\t\t\ttask_id=str(agent.task_id),\n\t\t\tfile_name=gif_path.name,\n\t\t\tfile_content=gif_content,  # Base64 encoded\n\t\t\tcontent_type='image/gif',\n\t\t)",
    "source": "github_repo:browser-use/browser-use",
    "file": "browser_use/agent/cloud_events.py",
    "license": "MIT",
    "language": "python"
}