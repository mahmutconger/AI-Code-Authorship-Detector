{
    "code": "import time\nfrom threading import Event, Thread\n\nclass CircuitBreaker:\n    def __init__(self, failure_threshold=5, reset_timeout=5):\n        self.failure_threshold = failure_threshold\n        self.reset_timeout = reset_timeout\n        self.failure_count = 0\n        self.last_failure_time = 0\n        self.open = Event()\n\n    def call(self, func):\n        if self.open.is_set():\n            return self.handle_open(func)\n        else:\n            try:\n                result = func()\n                self.handle_success()\n                return result\n            except Exception as e:\n                self.handle_failure()\n                return e\n\n    def handle_success(self):\n        self.failure_count = 0\n\n    def handle_failure(self):\n        self.failure_count += 1\n        self.last_failure_time = time.time()\n        if self.failure_count >= self.failure_threshold:\n            self.open.set()\n\n    def handle_open(self, func):\n        elapsed = time.time() - self.last_failure_time\n        if elapsed < self.reset_timeout:\n            time.sleep(self.reset_timeout - elapsed)\n        self.open.clear()\n        self.failure_count = 0\n        return func()\n\ndef function_that_fails():\n    raise Exception('Function failed')\n\ncircuit_breaker = CircuitBreaker()\nfor _ in range(10):\n    result = circuit_breaker.call(function_that_fails)\n    print(f'Call result: {result}')",
    "source": "test-data-ai",
    "prompt": "Circuit breaker pattern implementation yaz.",
    "license": "MIT",
    "language": "python"
}