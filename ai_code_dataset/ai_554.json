{
    "code": "from functools import reduce\nfrom math import ceil, log\n\ndef fenwick(n):\n    return [0] + [reduce(lambda a, b: a + b, range(i, 0, -1), [0]) for i in range(1, n + 1)]\n\ndef update(A, i, v):\n    while i <= len(A):\n        A[i] += v\n        i += i & -i\n\ndef query(A, i):\n    s = 0\n    while i > 0:\n        s += A[i]\n        i -= i & -i\n    return s\n\ndef rpquery(A, l, r):\n    return query(A, r) - query(A, l - 1)\n\ndef reverse_pairs(a):\n    n = len(a)\n    A = fenwick(n)\n    cnt = [0] * n\n    for x in a[::-1]:\n        cnt[x] += 1\n        l, r = x + 1, x + 2 ** (ceil(log(n, 2)))\n        if l < r:\n            update(A, l,  cnt[x])\n            update(A, r, -cnt[x])\n    return sum(rpquery(A, i, i + 1) for i in range(n))\n\nprint(reverse_pairs([4, 5, 1, 2, 3]))",
    "source": "test-data-ai",
    "prompt": "Reverse pairs using Fenwick tree yaz.",
    "license": "MIT",
    "language": "python"
}