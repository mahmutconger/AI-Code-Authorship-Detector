{
    "code": "from mpi4py import MPI\n\ndef compare_exchange(array, i, j, direction):\n    if (array[i] > array[j] and direction == 1) or (array[i] < array[j] and direction == 0):\n        array[i], array[j] = array[j], array[i]\n\ndef merge(array, low, count, direction):\n    if count > 1:\n        k = count // 2\n        for i in range(low, low+k):\n            compare_exchange(array, i, i+k, direction)\n        merge(array, low, k, direction)\n        merge(array, low+k, k, direction)\n\ndef bitonic_sort_parallel(array, low, count, direction):\n    if count > 1:\n        k = count // 2\n\n        comm = MPI.COMM_WORLD\n        rank = comm.Get_rank()\n        size = comm.Get_size()\n\n        if size > 1:\n            if rank != 0:\n                comm.send(array[low:low+count], dest=0)\n            else:\n                for i in range(1, size):\n                    data = comm.recv(source=i)\n                    array[low+(i-1)*k:low+(i-1)*k+len(data)] = data\n\n        bitonic_sort_parallel(array, low, k, 1)\n        bitonic_sort_parallel(array, low+k, k, 0)\n        merge(array, low, count, direction)\n\n        if size > 1:\n            if rank != 0:\n                comm.send(array[low:low+count], dest=0)\n            else:\n                for i in range(1, size):\n                    data = comm.recv(source=i)\n                    array[low+(i-1)*k:low+(i-1)*k+len(data)] = data\n\nif __name__ == '__main__':\n    array = [3, 7, 4, 8, 6, 2, 1, 5]\n    bitonic_sort_parallel(array, 0, len(array), 1)\n    print(array)",
    "source": "test-data-ai",
    "prompt": "Bitonic Sort algoritmasını paralel sıralama için yaz.",
    "license": "MIT",
    "language": "python"
}